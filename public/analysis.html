<!-- This is a static file -->
<!-- served from your routes in server.js -->

<!DOCTYPE html>
<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <title>Melodera</title>
    <meta name="description" content="Analyze songs, get recommendations, and/or view your listening habits" />
    <link rel="apple-touch-icon" sizes="180x180" href="icon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icon/favicon-16x16.png">
    <link rel="manifest" href="icon/site.webmanifest">
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" 
          rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" 
          crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
  </head>
  <body>
    <header class="rounded">
      <h1 class="siteName">
          Melodera
      </h1>
    </header>
    <nav class="navbar sticky-top navbar-expand-sm navbar-light rounded"
         style="background-color:#E4E7EB;
         box-shadow: 0 0.5rem 1rem rgb(0 0 0 / 5%), 
         inset 0 -1px 0 rgb(0 0 0 / 15%);">
      <div class="container-fluid" id="navContainer">
        <div id="homeAndTog">
          <a class="navbar-brand active" id="homeBtn" href="/analysis.html">
            <img class="logo-nav" max-height="10vh" src="images/melodera-logo.png">
          </a>
          <button class="navbar-toggler" onclick="toggledNav()" id="nav-tog" type="button" data-bs-toggle="collapse" 
                  data-bs-target="#navbarToggler1" aria-controls="navbarToggler1" 
                  aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon" id="toggled-nav-icon"></span>
          </button>
        </div>
        <div class="input-group" id="srchAndForm">
          <form class="d-flex" id="searchTrack">
              <div class="input-group">
                <input type="text" class="form-control" id="inputSrch" 
                       placeholder="Search songs, artists... " aria-label="SearchTerm" aria-describedby="searchBtn">
                <button class="btn btn-secondary" id="searchBtn" type="submit">
                  <i class="fa fa-search"></i>
                </button>
              </div>
          </form>
        </div>
        
        <div class="collapse navbar-collapse" id="navbarToggler1">
          
          <ul class="navbar-nav" id="navItems">
            <li class="nav-item">
              <a class="nav-link text-nowrap" id="librBtn" onclick="getMyLibrary();">
                Library
              </a>
            </li>
            <li class="nav-item dropdown" id="topOptions">
              <a class="nav-link dropdown-toggle" href="#" id="topOptionsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Top Listens
              </a>
              <ul class="dropdown-menu" aria-labelledby="topOptionsDropdown">
                <li><h6 class="dropdown-header">Songs</h6></li>
                <li><button class="dropdown-item" onclick="getTopTracks('short_term');" >Last 4 weeks</button></li>
                <li><button class="dropdown-item" onclick="getTopTracks('medium_term');">Last 6 months</button></li>
                <li><button class="dropdown-item" onclick="getTopTracks('long_term');">All time</button></li>
                <li><hr class="dropdown-divider"></li>
                <li><h6 class="dropdown-header">Artists</h6></li>
                <li><button class="dropdown-item" onclick="getTopArtists('short_term');">Last 4 weeks</button></li>
                <li><button class="dropdown-item" onclick="getTopArtists('medium_term');">Last 6 months</button></li>
                <li><button class="dropdown-item" onclick="getTopArtists('long_term');">All time</button></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <button class="btn dropdown-toggle" type="button" 
                      data-bs-toggle="dropdown" id="profDropdown" aria-expanded="false">
                <img id="profpic" alt="spot_pic">
              </button>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profDropdown">
                <li>
                  <button class="dropdown-item" 
                            data-bs-toggle="modal" data-bs-target="#profModal" 
                            onclick="openProfile();">
                    Profile
                  </button>
                </li>
                <li>
                  <button class="dropdown-item" 
                            data-bs-toggle="modal" data-bs-target="#visModal" 
                            onclick="openVisSettings();">
                    Visualizer / Guide
                  </button>
                </li>
                <li><button class="dropdown-item" onclick="logoutAcc()">Exit</button></li>
              </ul>
            </li>
          </ul>

        </div>
      </div>
      
    </nav>
    <div class="btn-group" role="group" aria-label="corner options">
      <button
          type="button"
          class="btn btn-floating btn-md"
          id="btn-back-to-top"
      >
        <i class="bi bi-arrow-up"></i>
      </button>
      <button
          type="button"
          class="btn btn-floating btn-md"
          id="btn-sync"
      >
        <i class="bi bi-music-note"></i>
      </button>
    </div>
    <section class="features">
            <!-- Modal -->
      <div class="modal fade" id="profModal" tabindex="-1" aria-labelledby="profModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="profModalTitle">Profile</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="profModalBody">
              ...
            </div>
          </div>
        </div>
      </div>
      <div class="modal fade" id="visModal" aria-hidden="true" aria-labelledby="visModalLabel" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="visModalTitle">How It Works</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="visModalBody">
              ...
            </div>
            <div class="modal-footer justify-content-center">
              <button type="button" class="btn btn-primary" 
                      data-bs-target="#customModal" 
                      data-bs-toggle="modal">Visualizer Settings (Experimental)</button>
            </div>
          </div>
        </div>
      </div>
      <div class="modal fade" id="customModal" aria-hidden="true" aria-labelledby="customModalLabel" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="customModalTitle">Shape of Visuals</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="customModalBody">
              <div class="d-grid gap-2 col-4 mx-auto">
                <button class="btn btn-primary visualizer-btns" 
                type="button" id="circVisual">Circle</button>
                <img src="images/circ_ex.png" 
                    class="img-fluid" alt="Player Guide">
                <button class="btn btn-primary visualizer-btns" 
                type="button" id="triVisual">Triangle</button>
                <img src="images/tri_ex.png" 
                    class="img-fluid" alt="Player Guide">
                <button class="btn btn-primary visualizer-btns"
                type="button" id="sqVisual">Square</button>
                <img src="images/sq_ex.png" 
                    class="img-fluid" alt="Player Guide">
                <button class="btn btn-primary visualizer-btns" 
                type="button" id="mixVisual">The Mix</button>
              </div>
            </div>
            <div class="modal-footer justify-content-center">
              <button class="btn btn-primary" data-bs-target="#visModal" data-bs-toggle="modal">Back To Guide</button>
              <button class="btn btn-primary" data-bs-toggle="modal" onclick="removeBeatVis()">Remove Visuals</button>
            </div>
          </div>
        </div>
      </div>
      <div id="results"></div>
      <hr
        id="dividerLine"
        style="
          margin-top: 50px;
          display: none;
          height: 2px;
          border-width: 0;
          color: gray;
          background-color: gray;
        "
      />
      <div id="features-chart-container">
        <div id="cover_and_play">
          <a id="linkalbum" style="margin: auto;"
                                   href="https://www.spotify.com" target="_blank"
            ><img
              id="artcover"
              class="img-fluid"
              src=" "
              width="300"
              height="300"
              alt="cover"
              style="display: none; border: 5px solid black; float: left;"
          /></a>
          <div id="play">
            <div class="playpausebutton">
              <div id="playedButton">
                <button class="paused" onclick="resumeVid()"></button>
              </div>
              <div id="pausedButton" style="display: none">
                <button class="played" onclick="pauseVid()"></button>
              </div>
            </div>
            <div id="bpmdisplay">
              <div
                class="displaybpm"
              >
                <p
                  id="BPM"
                ></p>
              </div>
              <button class="btn" id="fullScreenBtn"><i class="bi bi-fullscreen"></i></button>
            </div>
            <div
              id="displaysongstuff"
            >
              <p id="timer"></p>
            </div>
            <div class="bpmKey" style="margin: auto;">
              <text id="bpmAndKey"></text>
              <text id="instrumental"></text>
            </div>
            <div
              id="hideSongs"
              style="display: none; float: left;"
            >
              <div class="btn-group-vertical trackOptions">
                <button
                  class="btn btn-sm btn-aubergine"
                  onclick="showSimilar()"
                  id="showSimBtn"
                >
                  Show similar
                </button>
                <div class="btn-group dropend" id="partialSimBtns" style="height: 50%;">
                  <button
                    class="btn btn-sm btn-aubergine"
                    onclick="saveCurrTrack()"
                  >
                    Save song
                  </button>
                  <button
                    class="btn btn-sm btn-aubergine dropdown-toggle" 
                    data-bs-toggle="dropdown" aria-expanded="false"
                    onclick="popPlist()"
                  >
                    Add to playlist
                  </button>
                  <ul class="dropdown-menu dropdown-menu-sm " id="plistOptions">
                    <!-- Dropdown menu links -->
                  </ul>
                </div>
              </div>
            </div>
            <div
              id="displaysong"
            >
              <p id="albumart"></p>
            </div>
            <div aria-live="polite" aria-atomic="true" class="position-relative">
              <!-- - `.toast-container` for spacing between toasts -->
              <!-- - `.position-absolute`, `bottom-0` & `end-0` to position the toasts in the bottom right corner -->
              <!-- - `.p-3` to prevent the toasts from sticking to the edge of the container  -->
              <div class="toast-container position-absolute bottom-0 end-0 p-3" id="toastContain">

                <div class="toast align-items-center" id="saveSongToast" role="alert" 
                     aria-live="assertive" aria-atomic="true" data-bs-delay="3000">
                  <div class="d-flex">
                    <div class="toast-body">
                    Song saved
                    </div>
                    <button type="button" class="btn-close me-2 m-auto" 
                    data-bs-dismiss="toast" aria-label="Close"></button>
                  </div>
                </div>

                <div class="toast align-items-center" id="plistAddSongToast" role="alert" 
                     aria-live="assertive" aria-atomic="true" data-bs-delay="3000">
                  <div class="d-flex">
                    <div class="toast-body">
                    Song added to playlist
                    </div>
                    <button type="button" class="btn-close me-2 m-auto" 
                    data-bs-dismiss="toast" aria-label="Close"></button>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
        <canvas id="features-chart"></canvas>
        <canvas id="song-visual"></canvas>
      </div>
    </section>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" 
            crossorigin="anonymous">
    </script>
    <script src="https://sdk.scdn.co/spotify-player.js"></script>
    <script src="js/analysis.js"></script>
  </body>
</html>
